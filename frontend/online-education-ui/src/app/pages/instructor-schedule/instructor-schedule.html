<div class="calendar-page" *ngIf="agenda" #calendarContainer>
  <!-- HEADER -->
  <div class="calendar-header" (click)="$event.stopPropagation()">
    <div>
      <h2>EÄŸitmen HaftalÄ±k Ders Takvimi</h2>
      <span class="date-range">
        {{ agenda.weekStart | date:'dd MMM yyyy' }} -
        {{ displayWeekEnd | date:'dd MMM yyyy' }}
      </span>
    </div>

    <div class="nav-buttons">
      <button type="button" (click)="previousWeek()">â†</button>
      <button type="button" (click)="nextWeek()">â†’</button>
    </div>
  </div>

  <!-- GRID -->
  <div class="calendar-grid">
    <div class="day-column" *ngFor="let day of days">
      <div class="day-header">{{ day.label }}</div>

      <div class="events">
        <div
          class="event-pill"
          *ngFor="let ev of day.events"
          [style.background]="ev.color"
          (mousedown)="$event.preventDefault()"
          (click)="onEventClick($event, ev)"
        >
          <!-- ğŸ—‘ï¸ DELETE -->
          <button
            class="delete-btn"
            (click)="onDeleteClick($event, ev)"
            title="Dersi Sil"
          >
            ğŸ—‘ï¸
          </button>

          <div class="event-title">{{ ev.title }}</div>
          <div class="event-time">{{ ev.start }} - {{ ev.end }}</div>

          <div class="avatars">
            <span class="avatar" *ngFor="let p of ev.participants | slice:0:3">
              {{ getInitial(p.fullName) }}
            </span>
            <span *ngIf="ev.participantCount > 3" class="more">
              +{{ ev.participantCount - 3 }}
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ADD -->
<app-add-lesson-modal
  *ngIf="showAddLessonModal"
  (close)="showAddLessonModal = false"
  (lessonCreated)="onLessonCreated()"
></app-add-lesson-modal>

<!-- EDIT -->
<app-edit-lesson-modal
  *ngIf="showEditLessonModal"
  [lesson]="selectedEvent"
  (close)="showEditLessonModal = false"
  (lessonUpdated)="onLessonUpdated()"
></app-edit-lesson-modal>

<!-- DELETE CONFIRM -->
<div class="modal-backdrop" *ngIf="showDeleteConfirm">
  <div class="modal" (click)="$event.stopPropagation()">
    <h3>Dersi Sil</h3>

    <p>
      <strong>{{ lessonToDelete?.title }}</strong> adlÄ± dersi silmek
      istediÄŸinize emin misiniz?
    </p>

    <div class="actions" style="    display: flex;
    align-items: center;
    justify-content: space-between;">
        <button class="btn-secondary" (click)="cancelDelete()">Ä°ptal</button>
      <button class="btn-danger" (click)="confirmDelete()">Sil</button>
    </div>
  </div>
</div>
